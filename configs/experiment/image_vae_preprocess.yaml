# @package _global_

defaults:
  #- override /callbacks: default
  - override /trainer: ddp #gpu
  - override /logger: wandb
  - override /paths: default
#  - override /model: overfit
  #- override /data: minecraft_marsh 
  - override /model: preprocess 


tags: ["image", "latent_precompute", "minecraft"]

seed: 42 
test: False
ckpt_path: data/ckpts/ImageVAE_MCRAFT.ckpt

trainer: 
  log_every_n_steps: 1
  num_sanity_val_steps: 0
  precision: 16-true

data:
  _target_: src.data.datamodule_factory.DataModuleFactory
  batch_size: 1 #16
  num_workers: 16
  pin_memory: False 
  shuffle: False
  overwrite_split: #training
  dataset_cls:
    _target_: src.data.video.minecraft_marsh.MinecraftSimpleVideoDataset
    _partial_: True
    save_dir: /data/cvg/sebastian/minecraft_marsh 
    #latent_type: pre_sample  # Type of how latents are computed
    latent_suffix: 1cd9pgpb
    latent_downsampling_factor: [1, 8]  # [temporal, spatial]
    resolution: 256



model: 
  _target_: src.models.components.autoencoder.vae.image_vae.preprocessor.ImageVAEPreprocessor
  pretrained_path: data/ckpts/ImageVAE_MCRAFT.ckpt 
  pretrained_kwargs: {}
  precision: 16-true
#  latent_type: ${data.latent.type}
  max_encode_length: 250 #50 #10 #700 # number of frames that can be passed through the encoder at once
  max_video_length: 50 #300
  every_n_batch: 500


  # srs/eval.py experiment=image_vae_preprocess
